# Interpretable Machine Learning and DNN analysis for multiclass classification
A repository for application of BDTs and Shapley values to associated bbh production at HL-LHC and FCC-hh. Contains a DNN analysis to for comparison.

Resurrecting bbh with kinematic shapes  
Christophe Grojean, Ayan Paul, and Zhuoni Qian  
https://arxiv.org/abs/2011.13945

contact: Ayan Paul (<apaul2@alumni.nd.edu>)

If you use this code or the results of the work please cite:  

```
@article{Grojean:2020ech,
    author = "Grojean, Christophe and Paul, Ayan and Qian, Zhuoni",
    title = "{Resurrecting $b\bar{b}h$ with kinematic shapes}",
    eprint = "2011.13945",
    archivePrefix = "arXiv",
    primaryClass = "hep-ph",
    reportNumber = "DESY-20-175, HU-EP-20/28",
    month = "11",
    year = "2020"
}
```

- There are three Jupyter notebooks and all the data needed to do the full analysis.  
    - _BDT-Shapley.ipynb_ is a notebook for a boosted decision tree and Shapley value analysis for signal vs. multiclass background classification
    - _DNN.ipynb_ does the same with a Neural network. It is only a smaple analysis.
    - _Fit-2P.ipynb_ is a notebook for Bayesian MCMC using pymc3. 
- The simulations directory contains the MadGraph simulations for HL-LHC and FCC-hh
- The plots directory contains all the plots generated by the notebooks.
- _requirements_kernel.txt_ contains the packages required for the ipython kernel
- _requirements.txt_ contains all the pakages used in the notebooks

__NOTE:__ There is some version dependence between these packages:
- xgboost and shap
- arviz, theano, xarray and pymc3
for versions used please check _requirements.txt_  


The file tree is as follows:
```
.
├── notebooks
│   ├── BDT-Shapley.ipynb
│   ├── DNN.ipynb
│   ├── Fit-2P.ipynb
│   └── models
│       ├── FCC-BDT
│       └── HL-LHC-BDT
├── plots
│   ├── kappa_b-2P-FCC.pdf
│   ├── kappa_b-2P-HL-LHC.pdf
│   ├── kappa_b-2PO-FCC.pdf
│   ├── kappa_b-2PO-HL-LHC.pdf
│   ├── shap-5-FCC.pdf
│   ├── shap-5.pdf
│   ├── shap-yt2-yb2.pdf
│   ├── shap-zh-yb2.pdf
│   ├── yt2-yb2-BDT-dist.pdf
│   ├── zh-yb2-BDT-dist.pdf
│   └── zh-yb2-DNN-dist.pdf
├── README.md
├── requirement_kernel.txt
├── requirement.txt
└── simulations
    ├── FCC-hh
    │   ├── bbxaa.csv.tar.gz
    │   ├── yb2.csv.tar.gz
    │   ├── ybyt.csv.tar.gz
    │   ├── yt2.csv.tar.gz
    │   └── zh.csv.tar.gz
    └── HL-LHC
        ├── bbxaa.csv.tar.gz
        ├── yb2.csv.tar.gz
        ├── ybyt.csv.tar.gz
        ├── yt2.csv.tar.gz
        ├── zh.csv
        └── zh.csv.tar.gz
```
